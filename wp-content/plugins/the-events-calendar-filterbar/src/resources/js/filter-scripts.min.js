!function(e,t,i,r,s,n,a){e.extend(tribe_ev.fn,{set_form:function(t){var i=!1,s=e("body"),n=e(document.getElementById("tribe_events_filters_form")),a=e(document.getElementById("tribe-bar-form"));s.addClass("tribe-reset-on"),n.length&&(n.tribe_clear_form(),n.find(".ui-slider").length&&(i=!0,e("#tribe_events_filters_form .ui-slider").each(function(){var t=e(this).attr("id"),i=e("#"+t),r=i.prev(),s=r.prev(),n=i.slider("option");i.slider("values",0,n.min),i.slider("values",1,n.max),s.text(n.min+" - "+n.max),r.val("")}))),a.length&&a.tribe_clear_form(),t=r.parse_string(t),e.each(t,function(t,i){if("action"!==t){var r,s=decodeURIComponent(t);if(1===i.length)Array.isArray(i)&&(i=i[0]),i=decodeURIComponent(i.replace(/\+/g,"%20")),e('[name="'+s+'"]').is('input[type="text"], input[type="hidden"]')?e('[name="'+s+'"]').val(i):e('[name="'+s+'"][value="'+i+'"]').is(":checkbox, :radio")?e('[name="'+s+'"][value="'+i+'"]').prop("checked",!0):e('[name="'+s+'"]').is("select")&&e('select[name="'+s+'"] option[value="'+i+'"]').attr("selected",!0);else for(var n=0;n<i.length;n++)r=e('[name="'+s+'"][value="'+i[n]+'"]'),r.is(":checkbox, :radio")?r.prop("checked",!0):e('select[name="'+s+'"] option[value="'+i[n]+'"]').attr("selected",!0)}}),i&&e("#tribe_events_filters_form .ui-slider").each(function(){var t=e(this).attr("id"),i=e("#"+t),r=i.prev(),s=r.val().split("-");if(""!==s[0]){var n=r.prev();i.slider("values",0,s[0]),i.slider("values",1,s[1]),n.text(s[0]+" - "+s[1]),i.slider("refresh")}}),s.removeClass("tribe-reset-on")},update_current_filter:function(t,i){var r=e(t);if(r.closest(".tribe_events_filter_item").removeClass("active"),"slider"!==i){r.closest(".tribe_events_filter_item").find(".tribe-filter-status").text("");var s=r.serialize(),n="",a="";if(i=r.attr("type"),r.data("select2")){var l=r.select2("data");if(!l)return;l.text?r.closest(".tribe_events_filter_item").find(".tribe-filter-status").text(l.text.trim()):Array.isArray(l)&&(n=[],e(l).each(function(){n.push(this.text)}),0<n.length&&(a="",1<n.length&&(a=' <span class="tribe-events-filter-count">+'+(n.length-1)+"</span>"),r.closest(".tribe_events_filter_item").addClass("active").find(".tribe-filter-status").text(n[0].trim()).append(a)))}else"checkbox"===i&&(s=[],n=[],r.closest(".tribe_events_filter_item").find("input:checked").each(function(){s.push(e(this).val()),"tribe_featuredevent[]"===e(this).attr("name")?n.push(tribe_filter.featured_active_filter):n.push(e(this).closest("label").text())}),n&&(a="",1<n.length&&(a=' <span class="tribe-events-filter-count">+'+(n.length-1)+"</span>"),r.closest(".tribe_events_filter_item").addClass("active").find(".tribe-filter-status").text(n[0]).append(a)))}else{var o=r.slider("values");if(o){var c=tribe_filter.currency_symbol+o[0],_=tribe_filter.currency_symbol+o[1];tribe_filter.reverse_position&&(c=o[0]+tribe_filter.currency_symbol,_=o[1]+tribe_filter.currency_symbol),r.closest(".tribe_events_filter_item").addClass("active").find(".tribe-filter-status").text(c+" - "+_)}}},toggle_child_fields:function(t,i){e(".child-"+t).each(function(){i?e(this).slideUp():e(this).slideToggle();var t=r.get_parent_cat_id(this,!1);i&&t&&(e(this).toggleClass("closed"),r.toggle_child_fields(t,i))})},category_update:function(t){var i=e(t),s=i.attr("type"),n="";"tribe_eventcategory[]"===i.attr("name")&&"checkbox"===s&&(n=r.get_parent_cat_id(t,"closest"),n&&(i.closest("li").removeClass("closed"),r.toggle_child_cat_fields(n,i.prop("checked"))))},toggle_child_cat_fields:function(t,i){e(".child-"+t).each(function(){i?(e(this).slideDown(),e(this).find("input").prop("checked",!0)):e(this).find("input").prop("checked",!1);var t=r.get_parent_cat_id(this,!1);t&&(e(this).removeClass("closed"),r.toggle_child_cat_fields(t,i))})},get_parent_cat_id:function(t,i){var r="";return r="closest"===i?e.grep(e(t).closest("li").attr("class").split(" "),function(e){return 0===e.indexOf("parent-")}).join():"parent"===i?e.grep(e(t).parent().attr("class").split(" "),function(e){return 0===e.indexOf("parent-")}).join():e.grep(e(t).attr("class").split(" "),function(e){return 0===e.indexOf("parent-")}).join(),r=e.grep(r.split("-"),function(e){return e>0}).join()}}),e(document).ready(function(){function a(e){(e||"filters"===s.ajax_trigger&&t.v_width<t.mobile_break)&&(b.addClass("tribe-filters-closed").removeClass("tribe-filters-open"),tribe_storage&&tribe_storage.setItem("tribe_events_filters_wrapper","closed"),s.ajax_trigger="")}function l(){b.removeClass("tribe-filters-closed").removeClass("tribe-ajax-success").addClass("tribe-filters-open"),tribe_storage&&tribe_storage.setItem("tribe_events_filters_wrapper","open")}function o(){b.is(".tribe-filters-closed")?l():a(!0)}function c(){v.find(".tribe-events-filter-select2").each(function(){var t=e(this);t.find("input.tribe-dropdown").val(null).trigger("change")})}function _(){v.find(".tribe_events_filter_item.active").each(function(){e(this).removeClass("active")}),v.find(".tribe-filter-status").each(function(){e(this).text("")})}function d(){t.v_width<t.mobile_break&&a(!0)}function f(){"past"===s.view||"list"===s.view||"photo"===s.view||"map"===s.view?(s.paged=1,"past"!==s.view&&"list"!==s.view||s.filter_cats&&(t.cur_url=e(document.getElementById("tribe-events-header")).attr("data-baseurl"))):"month"===s.view?(s.date=e(document.getElementById("tribe-events-header")).attr("data-date"),s.filter_cats?t.cur_url=e(document.getElementById("tribe-events-header")).attr("data-baseurl"):t.cur_url=r.url_path(document.URL)):"week"!==s.view&&"day"!==s.view||(s.date=e(document.getElementById("tribe-events-header")).attr("data-date"))}function u(){r.disable_inputs("#tribe_events_filters_form","input, select"),s.popping=!1,f(),"map"===s.view?n.pushstate?r.pre_ajax(function(){e(i).trigger("tribe_ev_runAjax"),e(i).trigger("run-ajax.tribe"),s.ajax_trigger="filters"}):r.pre_ajax(function(){e(i).trigger("tribe_ev_reloadOldBrowser"),e(i).trigger("reload-old-browser.tribe")}):r.pre_ajax(function(){e(i).trigger("tribe_ev_runAjax"),e(i).trigger("run-ajax.tribe"),s.ajax_trigger="filters"})}e(".tribe_events_filter_item").filter(":last").addClass("tribe_last_child");var v=e(document.getElementById("tribe_events_filters_form")),p=e(".tribe-events-filters-horizontal"),g=e(document.getElementById("tribe-events")),b=e("body"),m=!(!g.length||!g.tribe_has_attr("data-hover-filters")||1!==g.data("hover-filters")),h=e(document.getElementById("tribe_events_filter_item_eventcategory"));if(e("#tribe_events_filter_item_eventcategory").length&&s.category&&(s.filter_cats=!0),tribe_storage){var x=tribe_storage.getItem("tribe_events_filters_wrapper");null==x&&b.is(".tribe-filters-closed")&&(x="closed"),x&&"closed"==x?a(!0):x&&"open"==x&&l(),e(".tribe_events_filter_item").each(function(){var t=e(this),i=t.attr("id"),r=tribe_storage.getItem(i);r&&"closed"==r&&t.addClass("closed")})}if(e(document.getElementById("tribe_events_filters_wrapper")).on("click","#tribe_events_filters_reset",function(t){t.preventDefault(),b.addClass("tribe-reset-on"),v.tribe_clear_form(),v.find(".ui-slider").length&&e("#tribe_events_filters_form .ui-slider").each(function(){var t=e(this).attr("id"),i=e("#"+t),r=i.prev(),s=r.prev(),n=i.slider("option");i.slider("values",0,n.min),i.slider("values",1,n.max),s.text(n.min+" - "+n.max),r.val("")}),p.length&&e(".tribe_events_filter_item").addClass("closed"),c(),_(),v.submit(),b.removeClass("tribe-reset-on")}).on("click","#tribe_events_filters_toggle",function(e){e.preventDefault(),o()}),b.on("click",function(){p.length&&!m&&e(".tribe_events_filter_item").addClass("closed")}).on("click",".tribe-events-filter-group",function(e){p.length&&!m&&e.stopPropagation()}),m&&v.on("mouseover",".tribe_events_filter_item",function(){p.length&&e(this).removeClass("closed")}).on("mouseout",".tribe_events_filter_item",function(){p.length&&e(".tribe_events_filter_item").addClass("closed")}),v.on("click","h3",function(t){if(!p.length||!m){var i=e(this),r=i.parent(),s=r.attr("id");p.length&&(t.stopPropagation(),e(".tribe_events_filter_item").not(r).addClass("closed")),r.hasClass("closed")?(r.removeClass("closed"),tribe_storage&&tribe_storage.setItem(s,"open")):(r.addClass("closed"),tribe_storage&&tribe_storage.setItem(s,"closed"))}}),d(),e(i).on("ajax-success.tribe",function(){a(!1)}).on("resize-complete.tribe",d),v.on("submit",function(t){"change_view"!==tribe_events_bar_action&&(t.preventDefault(),s.popping=!1,f(),r.pre_ajax(function(){e(i).trigger("tribe_ev_runAjax"),e(i).trigger("run-ajax.tribe"),s.ajax_trigger="filters"}))}),n.live_ajax()&&n.pushstate&&(v.find('input[type="submit"]').remove(),e(document.getElementById("tribe_events_filter_item_eventcategory")).length&&s.category&&e("#tribe_events_filter_item_eventcategory input, #tribe_events_filter_item_eventcategory select").on("change",function(){r.setup_ajax_timer(function(){u()})})),v.on("slidechange",".ui-slider",function(){r.update_current_filter(this,"slider"),n.live_ajax()&&r.setup_ajax_timer(function(){u()})}).on("change","input, select",function(){r.category_update(this),r.update_current_filter(this),s.filter_cats&&"tribe_events_filter_item_eventcategory"===e(this).parents(".tribe_events_filter_item").attr("id")||n.live_ajax()&&r.setup_ajax_timer(function(){u()})}),e(i).on("tribe_ev_collectParams",function(){var e=r.serialize("#tribe_events_filters_form","input, select");e.length?(s.filters=!0,s.params=s.params+"&"+e,"map"!==s.view&&(s.url_params.length?s.url_params=s.url_params+"&"+e:s.url_params=e)):s.filters=!1}),e(i).on("collect-params.tribe",function(){s.filter_cats&&e("#tribe_events_filter_item_eventcategory option:selected, #tribe_events_filter_item_eventcategory input:checked").remove();var t=r.serialize("#tribe_events_filters_form","input, select"),i=s.url_params&&"string"==typeof s.url_params?s.url_params.split("&"):[],n=t.split("&").filter(function(e){return i.indexOf(e)===-1}).join("&");s.url_params.length&&n.length?s.url_params=s.url_params+"&"+n:n.length&&(s.url_params=n)}),h.length&&s.category&&(b.addClass("tribe-reset-on"),h.find('option[data-slug="'+s.category+'"]').attr("selected",!0),h.find('input[data-slug="'+s.category+'"]').attr("checked","checked"),b.removeClass("tribe-reset-on")),h.length){var y=[];h.find("input:checked").each(function(){y.push(e(this).val())}),y.length&&h.find("li").each(function(){e(this).removeClass("closed").slideDown()})}e(document).on("click",".tribe-toggle-child",function(t){t.preventDefault();var i=r.get_parent_cat_id(this,"parent");e(this).parent().toggleClass("closed"),r.toggle_child_fields(i,e(this).parent().hasClass("closed"))})})}(jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);